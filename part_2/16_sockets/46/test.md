sudo ./main 
Listening for UDP packets...
Received packet from 192.168.0.1:53
Data: 6f b1 81 84 00 01 00 00 00 00 00 01 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00 00 ff 00 01 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 192.168.0.1:53

nslookup -type=any example.com
Server:         127.0.0.53
Address:        127.0.0.53#53

** server can't find example.com: NOTIMP
___________________________________________

Data: 6f b1 81 84 00 01 00 00 00 00 00 00 07 65 78 61 6d 70 6c 65 03 63 6f 6d 00 00 ff 00 01 
Received packet from 127.0.0.1:64634
Data: b7 04 01 00 00 01 00 00 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 
Received packet from 127.0.0.1:58791
Data: 28 5b 01 00 00 01 00 00 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 
Received packet from 192.168.0.1:53
Data: 45 65 81 80 00 01 00 03 00 00 00 01 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 c0 0c 00 05 00 01 00 00 00 6b 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 2f 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 65 75 73 31 33 06 65 61 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 71 00 01 00 01 00 00 00 2f 00 04 34 a8 75 aa 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: b7 04 81 80 00 01 00 03 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 c0 0c 00 05 00 01 00 00 00 6b 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 2f 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 65 75 73 31 33 06 65 61 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 71 00 01 00 01 00 00 00 2f 00 04 34 a8 75 aa 
Received packet from 192.168.0.1:53
Data: 05 d2 81 80 00 01 00 02 00 01 00 01 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 c0 0c 00 05 00 01 00 00 00 69 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 3a 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 77 75 73 30 39 06 77 65 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 82 00 06 00 01 00 00 00 3a 00 30 06 6e 73 31 2d 30 32 09 61 7a 75 72 65 2d 64 6e 73 c0 29 06 6d 73 6e 68 73 74 c0 1f 00 00 27 11 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 192.168.0.1:53
Data: b7 cc 81 80 00 01 00 00 00 01 00 01 10 6f 6e 65 64 73 63 6f 6c 70 72 64 77 75 73 30 39 06 77 65 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 03 63 6f 6d 00 00 41 00 01 c0 1d 00 06 00 01 00 00 00 1d 00 3a 06 6e 73 31 2d 30 32 09 61 7a 75 72 65 2d 64 6e 73 c0 33 06 6d 73 6e 68 73 74 09 6d 69 63 72 6f 73 6f 66 74 c0 33 00 00 27 11 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: 28 5b 81 80 00 01 00 02 00 01 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 c0 0c 00 05 00 01 00 00 00 69 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 3a 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 77 75 73 30 39 06 77 65 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 82 00 06 00 01 00 00 00 3a 00 30 06 6e 73 31 2d 30 32 09 61 7a 75 72 65 2d 64 6e 73 c0 29 06 6d 73 6e 68 73 74 c0 1f 00 00 27 11 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 
Received packet from 192.168.0.101:68
Data: 01 01 06 00 8e 4f c4 a7 00 06 00 00 c0 a8 00 65 00 00 00 00 00 00 00 00 00 00 00 00 80 30 49 44 15 e3 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 63 82 53 63 35 01 03 3d 07 01 80 30 49 44 15 e3 0c 08 50 79 61 74 61 6e 69 6e 51 0b 00 00 00 50 79 61 74 61 6e 69 6e 3c 08 4d 53 46 54 20 35 2e 30 37 0e 01 03 06 0f 1f 21 2b 2c 2e 2f 77 79 f9 fc ff 
Received packet from 127.0.0.1:58186
Data: c0 a0 01 00 00 01 00 00 00 00 00 00 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 01 00 01 
Received packet from 192.168.0.1:53
Data: 60 6f 81 80 00 01 00 06 00 00 00 01 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 01 00 01 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 8a c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 8b c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 64 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 66 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 71 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 65 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: c0 a0 81 80 00 01 00 06 00 00 00 00 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 01 00 01 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 8a c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 8b c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 64 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 66 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 71 c0 0c 00 01 00 01 00 00 00 69 00 04 ad c2 49 65 
Received packet from 127.0.0.1:51768
Data: 1d b5 01 00 00 01 00 00 00 00 00 00 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 1c 00 01 
Received packet from 192.168.0.1:53
Data: 3e ca 81 80 00 01 00 04 00 00 00 01 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 1c 00 01 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 66 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 8a c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 71 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 65 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: 1d b5 81 80 00 01 00 04 00 00 00 00 06 67 6f 6f 67 6c 65 03 63 6f 6d 00 00 1c 00 01 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 66 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 8a c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 71 c0 0c 00 1c 00 01 00 00 00 00 00 10 2a 00 14 50 40 10 0c 0e 00 00 00 00 00 00 00 65 
Received packet from 127.0.0.1:8781
Data: 1f 00 01 00 00 01 00 00 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 
Received packet from 127.0.0.1:31117
Data: c1 54 01 00 00 01 00 00 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 
Received packet from 192.168.0.1:53
Data: 38 57 81 80 00 01 00 03 00 00 00 01 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 c0 0c 00 05 00 01 00 00 00 5b 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 2e 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 65 75 73 31 34 06 65 61 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 71 00 01 00 01 00 00 00 2d 00 04 14 2a 41 5a 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: 1f 00 81 80 00 01 00 03 00 00 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 01 00 01 c0 0c 00 05 00 01 00 00 00 5b 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 2e 00 29 10 6f 6e 65 64 73 63 6f 6c 70 72 64 65 75 73 31 34 06 65 61 73 74 75 73 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 c0 71 00 01 00 01 00 00 00 2d 00 04 14 2a 41 5a 
Received packet from 192.168.0.1:53
Data: 56 5c 81 80 00 01 00 02 00 01 00 01 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 c0 0c 00 05 00 01 00 00 00 42 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 06 00 2a 10 6f 6e 65 64 73 63 6f 6c 70 72 64 75 6b 73 30 35 07 75 6b 73 6f 75 74 68 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 06 65 61 73 74 75 73 c0 8a 00 06 00 01 00 00 00 3c 00 31 07 6e 73 31 2d 32 30 31 09 61 7a 75 72 65 2d 64 6e 73 c0 29 06 6d 73 6e 68 73 74 c0 1f 00 00 27 11 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 192.168.0.1:53
Data: c2 04 81 80 00 01 00 00 00 01 00 01 10 6f 6e 65 64 73 63 6f 6c 70 72 64 75 6b 73 30 35 07 75 6b 73 6f 75 74 68 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 03 63 6f 6d 00 00 41 00 01 c0 1d 00 06 00 01 00 00 00 1e 00 3a 06 6e 73 31 2d 30 31 09 61 7a 75 72 65 2d 64 6e 73 c0 34 06 6d 73 6e 68 73 74 09 6d 69 63 72 6f 73 6f 66 74 c0 34 00 00 00 01 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 00 00 29 04 d0 00 00 00 00 00 00 
Received packet from 127.0.0.53:53
Data: c1 54 81 80 00 01 00 02 00 02 00 00 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 09 6d 69 63 72 6f 73 6f 66 74 03 63 6f 6d 00 00 41 00 01 c0 0c 00 05 00 01 00 00 00 42 00 27 06 6d 6f 62 69 6c 65 06 65 76 65 6e 74 73 04 64 61 74 61 0e 74 72 61 66 66 69 63 6d 61 6e 61 67 65 72 03 6e 65 74 00 c0 3e 00 05 00 01 00 00 00 06 00 2a 10 6f 6e 65 64 73 63 6f 6c 70 72 64 75 6b 73 30 35 07 75 6b 73 6f 75 74 68 08 63 6c 6f 75 64 61 70 70 05 61 7a 75 72 65 c0 29 06 65 61 73 74 75 73 c0 8a 00 06 00 01 00 00 00 3c 00 31 07 6e 73 31 2d 32 30 31 09 61 7a 75 72 65 2d 64 6e 73 c0 29 06 6d 73 6e 68 73 74 c0 1f 00 00 27 11 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c c0 82 00 06 00 01 00 00 00 1e 00 1f 06 6e 73 31 2d 30 31 c0 b6 c0 c2 00 00 00 01 00 00 03 84 00 00 01 2c 00 09 3a 80 00 00 00 3c 

 nslookup google.com
Server:         127.0.0.53
Address:        127.0.0.53#53

Non-authoritative answer:
Name:   google.com
Address: 173.194.73.138
Name:   google.com
Address: 173.194.73.139
Name:   google.com
Address: 173.194.73.100
Name:   google.com
Address: 173.194.73.102
Name:   google.com
Address: 173.194.73.113
Name:   google.com
Address: 173.194.73.101
Name:   google.com
Address: 2a00:1450:4010:c0e::66
Name:   google.com
Address: 2a00:1450:4010:c0e::8a
Name:   google.com
Address: 2a00:1450:4010:c0e::71
Name:   google.com
Address: 2a00:1450:4010:c0e::65


____________________________________________
а так сработало... Видимо такой запрос не поддерживается
slookup -type=A example.com
Server:         127.0.0.53
Address:        127.0.0.53#53

Non-authoritative answer:
Name:   example.com
Address: 23.192.228.84
Name:   example.com
Address: 23.215.0.136
Name:   example.com
Address: 23.215.0.138
Name:   example.com
Address: 96.7.128.175
Name:   example.com
Address: 96.7.128.198
Name:   example.com
Address: 23.192.228.80
